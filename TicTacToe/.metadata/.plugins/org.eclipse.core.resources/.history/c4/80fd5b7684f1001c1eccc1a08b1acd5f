package com.springboot.app.game.service;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.springboot.app.game.clients.BoardClientRest;
import com.springboot.app.game.clients.PlayerClientRest;
import com.springboot.app.game.dto.BoardDto;
import com.springboot.app.game.dto.GameDto;
import com.springboot.app.game.dto.PlayerDto;
import com.springboot.app.game.entities.GameEntity;
import com.springboot.app.game.repository.GameRepository;
import com.springboot.app.game.utils.Console;


@Service
public class GameService implements IGameService {
		
	@Autowired
	private PlayerClientRest playerClientRest;
	
	@Autowired
	private BoardClientRest boardClientRest;
	
	@Autowired
	private GameRepository gameRepository;
	
	
	private static final Logger log = LoggerFactory.getLogger(GameService.class);

	
	private static GameEntity game = new GameEntity();

	@Override
	public GameEntity create(String username_1, String username_2) {
		game.setPlayer_id_1(playerClientRest.getIdByUsername(username_1));
		game.setPlayer_id_2(playerClientRest.getIdByUsername(username_2));
		game.setBoard_id(boardClientRest.createBoardAndGetId());
		gameRepository.save(game);
		return game;
	}

	@Override
	public GameDto getGame() {
		PlayerDto playerDto = new PlayerDto();
		GameDto gameDto = new GameDto();
		BoardDto boardDto = playerClientRest.getBoardById(game.getBoard_id());
		playerDto.setData(playerClientRest.getPlayerById(game.getPlayer_id_1()));
		playerDto.setData(playerClientRest.getPlayerById(game.getPlayer_id_2()));
		gameDto.setPlayer_1(playerDto);
		gameDto.setPlayer_2(playerDto);
		return gameDto;
	}

}
